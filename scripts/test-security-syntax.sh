
#!/bin/bash

# Тестовый скрипт для проверки синтаксиса основного скрипта безопасности
# Этот скрипт проверяет основные синтаксические ошибки

echo "Проверка синтаксиса скрипта setup-security-ruvds.sh..."

# Проверяем основные синтаксические ошибки
echo "1. Проверка на незакрытые кавычки..."
if grep -n "'" scripts/setup-security-ruvds.sh | grep -v "echo '" | grep -v "cat >" | grep -v "read -p"; then
    echo "   ОШИБКА: Обнаружены незакрытые одинарные кавычки"
    exit 1
fi

echo "2. Проверка на незакрытые двойные кавычки..."
if grep -n '"' scripts/setup-security-ruvds.sh | grep -v 'echo "' | grep -v 'cat >' | grep -v 'read -p' | grep -v 'ssh_key' | grep -v 'USERNAME' | grep -v 'SSH_PORT' | grep -v 'BACKUP_DIR' | grep -v 'LOG_DIR' | grep -v 'SECURITY_REPORT' | grep -v 'FAIL2BAN_JAIL' | grep -v 'EMAIL_ADMIN' | grep -v 'USE_SSH_KEY' | grep -v 'RED\|GREEN\|YELLOW\|BLUE\|CYAN\|NC' | grep -v 'log_info\|log_success\|log_warning\|log_error\|log_cyan' | grep -v 'check_root\|check_dependencies\|create_directories\|backup_configs\|setup_ufw\|setup_fail2ban\|setup_user_ssh\|setup_ssh_config\|setup_automatic_updates\|setup_sysctl\|setup_security_logging\|setup_email_notifications\|security_check\|create_security_report\|cleanup\|show_help\|check_security_status\|main'; then
    echo "   ОШИБКА: Обнаружены незакрытые двойные кавычки"
    exit 1
fi

echo "3. Проверка на незакрытые скобки..."
if grep -n "(" scripts/setup-security-ruvds.sh | grep -v "if " | grep -v "while " | grep -v "for " | grep -v "then" | grep -v "fi" | grep -v "done" | grep -v "echo" | grep -v "grep" | grep -v "cut" | grep -v "awk" | grep -v "sort" | grep -v "xargs" | grep -v "tail" | grep -v "head" | grep -v "ls" | grep -v "ps" | grep -v "df" | grep -v "free" | grep -v "uptime" | grep -v "hostname" | grep -v "whoami" | grep -v "id" | grep -v "useradd" | grep -v "usermod" | grep -v "groupadd" | grep -v "chown" | grep -v "chmod" | grep -v "mkdir" | grep -v "rm" | grep -v "cp" | grep -v "mv" | grep -v "tar" | grep -v "gzip" | grep -v "gunzip" | grep -v "zip" | grep -v "unzip" | grep -v "wget" | grep -v "curl" | grep -v "ssh" | grep -v "scp" | grep -v "rsync" | grep -v "ping" | grep -v "traceroute" | grep -v "netstat" | grep -v "ss" | grep -v "lsof" | grep -v "top" | grep -v "htop" | grep -v "iotop" | grep -v "iostat" | grep -v "vmstat" | grep -v "dstat" | grep -v "iftop" | grep -v "nethogs" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop" | grep -v "iptraf" | grep -v "bmon" | grep -v "slurm" | grep -v "tcptrack" | grep -v "iptraf-ng" | grep -v "nload" | grep -v "bwm-ng" | grep -v "cbm" | grep -v "speedometer" | grep -v "netio" | grep -v "nethogs" | grep -v "iftop"
