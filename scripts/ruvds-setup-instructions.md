# Инструкция по запуску скрипта настройки VPS RUVDS

## Предварительные требования

1. **Заказанный VPS сервер** на RUVDS с Ubuntu 22.04 LTS
2. **Root доступ** к серверу
3. **Интернет-соединение** на сервере

## Шаги запуска скрипта

### 1. Подключение к серверу

```bash
# Подключитесь к серверу как root
ssh root@ВАШ_IP_АДРЕС
```

### 2. Копирование скрипта на сервер

```bash
# Если скрипт уже есть на сервере, переходите к шагу 3
# Если нужно скопировать с локальной машины:
scp ruvds-vps-setup.sh root@ВАШ_IP_АДРЕС:/tmp/
```

### 3. Перемещение скрипта в нужную директорию

```bash
# Перемещаем скрипт в /usr/local/bin
mv /tmp/ruvds-vps-setup.sh /usr/local/bin/

# Делаем скрипт исполняемым
chmod +x /usr/local/bin/ruvds-vps-setup.sh
```

### 4. Запуск скрипта

```bash
# Запускаем скрипт от имени root
sudo ruvds-vps-setup.sh
```

Или если вы находитесь в директории со скриптом:

```bash
# Запускаем скрипт
./ruvds-vps-setup.sh
```

## Что делает скрипт

Скрипт выполняет следующие действия автоматически:

### Часть 1: Исследование тарифов RUVDS

- Показывает информацию о тарифах
- Рекомендует оптимальную конфигурацию
- Описывает дополнительные опции

### Часть 2: Пошаговые инструкции по заказу VPS

- Регистрация на RUVDS
- Пополнение счета
- Выбор конфигурации
- Оплата и активация

### Часть 3: Настройка SSH ключей

- Генерация SSH ключей
- Настройка SSH конфигурации
- Интеграция с RUVDS

### Часть 4: Базовая настройка системы

- Обновление системы
- Установка необходимых пакетов
- Настройка swap (2GB)
- Конфигурация firewall
- Настройка часового пояса

### Часть 5: Установка Node.js и Nginx

- Установка Node.js 18.x
- Настройка Nginx для NORMALDANCE
- Конфигурация прокси для API

### Часть 6: Создание пользователя normaldance

- Создание пользователя с sudo правами
- Настройка SSH доступа
- Полезные алиасы в .bashrc

### Часть 7: Отключение root доступа по SSH

- Безопасное отключение root входа
- Резервное копирование конфигурации

### Часть 8: Финальная настройка и проверка

- Проверка всех сервисов
- Отчет о настройке
- Инструкции по следующим шагам

## После запуска скрипта

### 1. Подключение как новый пользователь

```bash
# После отключения root доступа
ssh normaldance@ВАШ_IP_АДРЕС
```

### 2. Клонирование репозитория NORMALDANCE

```bash
cd /var/www
git clone https://github.com/normaldance/project.git
cd project
```

### 3. Установка зависимостей

```bash
npm install
```

### 4. Запуск проекта

```bash
# Для разработки
npm run dev

# Для продакшена
npm start
```

### 5. Настройка доменного имени (опционально)

```bash
# Установка Certbot для SSL
sudo apt install certbot python3-certbot-nginx

# Получение SSL сертификата
sudo certbot --nginx -d ваш-домен.ru
```

## Проверка работы

После настройки вы можете проверить:

1. **Веб-сервер**: откройте в браузере `http://ВАШ_IP_АДРЕС`
2. **API**: `http://ВАШ_IP_АДРЕС/api`
3. **Статус Nginx**: `sudo systemctl status nginx`
4. **Статус Node.js**: `sudo systemctl status node`

## Полезные команды

### Управление Nginx

```bash
sudo systemctl start nginx    # Запуск
sudo systemctl stop nginx     # Остановка
sudo systemctl restart nginx  # Перезапуск
sudo systemctl status nginx  # Статус
sudo nginx -t               # Тест конфигурации
```

### Управление проектом

```bash
nd-start    # Запуск проекта
nd-dev      # Запуск в режиме разработки
nd-build    # Сборка проекта
nd-log      # Логи Nginx
```

### Мониторинг

```bash
htop        # Мониторинг процессов
df -h       # Дисковое пространство
free -h     # Использование памяти
```

## Важные замечания

1. **Скрипт должен запускаться только от имени root**
2. **Интернет-соединение обязательно** для работы скрипта
3. **Не прерывайте выполнение** скрипта во время работы
4. **Сохраняйте данные доступа** после настройки
5. **Регулярно делайте бэкапы** важных данных

## Тroubleshooting

### Если скрипт не запускается

```bash
# Проверка прав доступа
ls -la /usr/local/bin/ruvds-vps-setup.sh

# Если нет прав, выполните:
chmod +x /usr/local/bin/ruvds-vps-setup.sh
```

### Если возникли ошибки прав доступа

```bash
# Проверка прав root
whoami

# Если не root, выполните:
sudo su
```

### Если интернет не работает

```bash
# Проверка подключения
ping ruvds.com
ping 8.8.8.8
```

## Контакты поддержки

Если у вас возникли вопросы:

- Проверьте логи скрипта
- Свяжитесь с технической поддержкой RUVDS
- Обратитесь к документации NORMALDANCE
